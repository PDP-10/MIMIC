;
	TITLE VM15CM		MIMIC-15	COMMUNICATIONS REGION		
;
;DEFAULT CONFIGURATION:
;
	IFNDEF CLK,<CLK=0>
	IFNDEF PTR,<PTR=0>
	IFNDEF PTP,<PTP=0>
	IFNDEF EAE,<EAE=0>
	IFNDEF DTA,<DTA=0>
	IFNDEF DSK,<DSK=0>
	IFNDEF LPT,<LPT=0>
;
;
	EXTERN PION,IOT33,IOT77,.FETCH
	INTERN .IOTLS,ILLPTR
	EXTERN TKBDDM,TTYDDM,TKBP,TTYP,CPUDDM,ILLEG
	INTERN CDMLST,CPUJMP
;
;VARIABLE LENGTH LISTS.
;
CDMLST:	XWD 0,CPUDDM	;CPU
	XWD 0,TKBDDM	;TTYPE DDM
	XWD 0,TTYDDM
	DDMORG=.	;OTHER DDMS WILL BE ADDED HERE
	BLOCK ^D10
;
	SUBTTL	MIMIC-15	CONFIGURATION AND DDM LIST
	SUBTTL	MIMIC-15	I-O DEVICE BRANCH TABLE
IOTORG:
.IOTLS:	JUMPA ,@CPUJMP(XR2)	;CPU-DECODED IOTS.
	JRST ILLPTR	;PTR
	JRST ILLPTR	;PTP
	JRST TKBP	;TKB
	JRST TTYP	;TTY
	REPEAT ^D22,<	JRST ILLPTR>	;DEVICES 5-32
	JRST IOT33	;CRAZIES
	REPEAT ^D35,<	JRST ILLPTR>	;DEVICES 34-76
	JRST IOT77	;EXTENDED MEMORY
;
ILLPTR:	JRST ILLEG	;ALL DISPATCH TABLE ILLEGAL JUMPS COME HERE
	;INSTEAD OF GOING DIRECTLY TO ILLEG BECAUSE SOME
	;OF THE JUMPS WILL BE OVERLAYED, BREAKING THE CHAIN OF
	;EXTERN REFERENCES AND FUCKING UP THE LOADER.
;
CPUJMP:	JRST ILLPTR	;EAE SWITCH
	JRST ILLPTR	;CLSF SWITCH
	JRST PION	;7000X2=ION GROUP
	JRST ILLPTR
	JRST ILLPTR	;CLOCK SWITCH
	JRST ILLPTR
	JRST ILLPTR
	JRST ILLPTR
;
	SUBTTL	MIMIC-15	CONDITIONAL EXTRACTOR ASSEMBLY
;
IFN PTP,<	EXTERN PTPDDM,PTPP
	RELOC DDMORG
	XWD 0,PTPDDM
	DDMORG=.
	Z
	RELOC IOTORG+2
	JRST PTPP	>

IFN PTR,<	EXTERN PTRDDM,PTRP
	RELOC DDMORG
	XWD 0,PTRDDM
	DDMORG=.
	Z
	RELOC IOTORG+1
	JRST PTRP	>

IFN CLK,<	EXTERN CLKDDM,CLKP,PCLSF
	RELOC DDMORG
	XWD 0,CLKDDM
	DDMORG=.
	Z
	RELOC CPUJMP+1
	JRST PCLSF
	RELOC CPUJMP+4
	JRST CLKP	>

IFN EAE,<	EXTERN PEAE
	RELOC CPUJMP
	JRST PEAE>

IFN LPT,<	EXTERN LPTDDM,LPTP
	RELOC DDMORG
	Z ,LPTDDM
	DDMORG=.
	Z
	RELOC IOTORG+17
	JRST LPTP>

IFN DSK,<	EXTERN RF15DDM,RF1570,RF1572
	RELOC DDMORG
	XWD 0,RF15DDM
	DDMORG=.
	Z
	RELOC IOTORG+70
	JRST RF1570
	RELOC IOTORG+72
	JRST RF1572>

IFN DTA,<	EXTERN DTADDM,DT75P,DT76P
	RELOC DDMORG
	Z ,DTADDM
	DDMORG=.
	Z
	RELOC IOTORG+75
	JRST DT75P
	JRST DT76P>
	END
	Z
	RELOC IOTORG+30
	JRST BB30P
	JRST BB31P	>
;
;
;
	END
