;
	TITLE CPUDDM		MIMIC-15	CENTRAL PROCESSOR DESCRIPTOR		
;
	ENTRY CPUDDM
	EXTERN .READ,.WRITE,.LOADR,.TRDN,.BLDUP,.FETCH,ADDRNT
	EXTERN BRSET,SLPCHK,CPURD,CPUWR,CPURST,NULL,.FLAGS
	INTERN ITIM,EAEACS,SMQ,SLAC,LDRUCB,SYSLST,SR,BRKARY
	INTERN CPUUCB,SC,OLDPC,STM,SIO,C,RELOCC
	INTERN LR,XR,TRAPS,SPC,LDRBUF,LDRDAT,LDRADR,LDRFLG
;
CPUDDM:	DDM1 CPU,CPURDB,CPUUCB
	DDM2 10,^D15,10,^D18
	DDM3 QADR+QFIX+QBRK,^D18,MEMSIZ
	DDM4 CPURD,CPUWR,CPURST,ADDRNT,BRSET,SLPCHK
;
CPUUCB:	UCB CPU,0,CPUDDM,NULL,0,QADR+QFIX+QBRK
;
EAEACS:	Z	;EAE AC SIGN
OLDPC:	Z	;OLD PC
SC:	Z	;SHIFT COUNTER
SR:	Z	;SWITCH REGISTER
LR:	Z	;LIMIT REGISTER.
XR:	Z	;INDEX REGISTER.
;
ITIM:	Z	;INTERVAL TIMER.
	Z	;LAST UPDATE OF ITIM.
TRAPS:	200000000000	;SET ILLMEM ON.
STM:	Z	;SAVED LIVE REGISTERS:  TIME
SIO:	Z	;I-O FLAGS  BM, UM, DBR, ETC.
SIR:	Z	;INSTRUCTION REGISTER
SPC:	Z	;PROGRAM COUNTER
SLAC:	Z	;LINK AC
SMQ:	Z	;MQ
SMA:	Z	;MEMORY ADDRESS
SMB:	Z	;MEMORY BUFFER
	BLOCK 3	;INDEX REGISTERS
;
	SUBTTL	MIMIC-15	DDM HEADER AND UCB
	SUBTTL	MIMIC-15	REGISTER DESCRIPTION BLOCKS
;
CPURDB:	RDB AC,SLAC,18	;REGISTERS:  AC
;
	RDB XR,XR,18
;
	RDB LR,LR,18
;
	FLG BNK,SIO,0
;
	RDB SR,SR,18	;SWITCHES
;
CPUPC:	RDB PC,SPC,18	;PC
;
	RDB STAT,SIO,19	;I/O STATUS.
;
	DRDB CORE,CPUDDM+DNFRM,18,P
;
	RDB OLDPC,OLDPC,18,P	;OLD PC
;
	RDB MQ,SMQ,18	;MQ
;
	FLG L,SLAC,^D17	;LINK
;
	FLG LINK,SLAC,^D17
;
	RDB SC,SC,6
;
	DRDB TM,STM,36,P
	DRDB ITM,ITIM,36	;INTERVAL TIMER
;
	RDB IR,IR,4,P
;
	RDB MA,SMA,15,P
;
	RDB MB,SMB,18,P
;
	RDB ASR,RELOCC,15
;
	FLG LDRFLG,LDRFLG,0
;
	RDB LDRADR,LDRADR,18
;
	RDB LDRDAT,LDRDAT,18
;
	FLG SINGLE,.FLAGS,1
;
	FLG SI,.FLAGS,1
;
	FLG ILLEG,TRAPS,0
;
	FLG ILLMEM,TRAPS,1
;
	FLG ION,SIO,^D18	;INTERRUPTS ENABLED.
;
	FLG TRAP,SIO,1	;TRAPS ENABLED
;
	FLG EXT,SIO,0	;EXTENDED MEMORY ENABLED.
;
	Z
;
	SUBTTL	MIMIC-15	CORE STORAGE
;
;
	IFNDEF CPU,<CPU=^D12>
	MEMSIZ=CPU*^D1024
C:	XLIST	;UNLIST CORE ARRAY
	REPEAT <MEMSIZ/2>,<0>
BRKARY:	REPEAT <MEMSIZ/^D32>,<0>
	LIST
;
	SUBTTL	MIMIC-15	SYSLST BLOCK
;
SYSLST:	SIXBIT /PDP15/
	Z,.FETCH
	Z,CPUPC
	XWD .LOADR,LDRUCB
	Z,.BLDUP
	Z,.TRDN
	DDM3 QADR+QRD+QATBL,^D36,0
	Z,STM
;
LDRUCB:	UCB LDR,0,SYSLST,NULL,LDRFAB,QADR+QRD+QATBL
;
RELOCC:	Z
LDRADR:	Z
LDRDAT:	Z
LDRFLG:	Z
;
LDRFAB:	FAB LDR,0	;FILE ACCESS BLOCK FOR LOADR
	END
